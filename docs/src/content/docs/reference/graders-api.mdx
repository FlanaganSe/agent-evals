---
title: Graders API
description: Reference for all built-in graders
---

agent-evals ships 20 built-in graders across three tiers: **deterministic** (pure functions — fast, free, reproducible), **LLM** (require a judge configuration), and **composition** (combine other graders with boolean logic).

## Text Graders

### `contains`

Checks if output text contains a substring. Case-insensitive by default.

```typescript
contains("Paris")
contains("Paris", { caseSensitive: true })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `caseSensitive` | boolean | `false` | Enable case-sensitive matching |

### `notContains`

Checks that output text does NOT contain a substring. Case-insensitive by default.

```typescript
notContains("sorry")
notContains("ERROR", { caseSensitive: true })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `caseSensitive` | boolean | `false` | Enable case-sensitive matching |

### `exactMatch`

Checks that output text exactly equals the expected string. Trims whitespace by default.

```typescript
exactMatch("42")
exactMatch("Hello World", { trim: false, caseSensitive: false })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `trim` | boolean | `true` | Trim whitespace before comparing |
| `caseSensitive` | boolean | `true` | Enable case-sensitive comparison |

### `regex`

Tests output against a regular expression. Accepts a string or RegExp.

```typescript
regex(/\d{3}-\d{4}/)
regex("\\d+\\.\\d{2}", { flags: "i" })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `flags` | string | — | Regex flags (only for string patterns) |

### `jsonSchema`

Parses output text as JSON and validates against a Zod schema. Fails if text is not valid JSON or does not match the schema.

```typescript
import { z } from "zod";

jsonSchema(z.object({ name: z.string(), age: z.number() }))
```

## Tool Call Graders

### `toolCalled`

Checks that a specific tool was invoked in the output tool calls.

```typescript
toolCalled("search")
```

### `toolNotCalled`

Checks that a specific tool was NOT invoked.

```typescript
toolNotCalled("deleteAll")
```

### `toolSequence`

Checks that tool calls match an expected sequence. Four modes available.

```typescript
toolSequence(["search", "summarize"])                  // unordered (default)
toolSequence(["search", "summarize"], "strict")        // exact order
toolSequence(["search"], "subset")                     // expected tools appear in actual
toolSequence(["search", "summarize", "save"], "superset") // actual tools appear in expected
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `mode` | string | `"unordered"` | Match mode: `strict`, `unordered`, `subset`, `superset` |

### `toolArgsMatch`

Checks that a tool call's arguments match expected values.

```typescript
toolArgsMatch("search", { query: "weather" })                    // subset (default)
toolArgsMatch("search", { query: "weather" }, "exact")           // deep equality
toolArgsMatch("search", { query: "weather" }, "contains")        // strings use .includes()
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `mode` | string | `"subset"` | Match mode: `exact`, `subset`, `contains` |

## Metric Graders

### `latency`

Checks that response latency (`output.latencyMs`) is within the allowed threshold.

```typescript
latency(5000)
```

### `cost`

Checks that response cost (`output.cost`) is within budget. Skips if cost is not reported.

```typescript
cost(0.05)
```

### `tokenCount`

Checks that total token usage (input + output) is within the allowed limit. Skips if token usage is not reported.

```typescript
tokenCount(4096)
```

## Safety Graders

### `safetyKeywords`

Checks that output text does NOT contain any prohibited keywords. Case-insensitive matching.

```typescript
safetyKeywords(["guaranteed returns", "buy now", "act fast"])
```

### `noHallucinatedNumbers`

Checks that numbers in output text are grounded in tool call results. Catches fabricated numbers — the most dangerous agent failure mode.

```typescript
noHallucinatedNumbers()
noHallucinatedNumbers({ tolerance: 0.01, skipSmallIntegers: false })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `tolerance` | number | `0.005` | Relative tolerance for matching (0.005 = 0.5%) |
| `skipSmallIntegers` | boolean | `true` | Skip integers with absolute value < 10 |

Always skips year-like numbers (1900–2100). Score is proportional: `(checked - hallucinated) / checked`.

## LLM Graders

These require a `judge` configuration in your eval config. See [Configuration](/reference/config/) for setup.

### `llmRubric`

Scores agent output against natural language criteria using an LLM judge. Judge scores 1–4 (poor to excellent).

```typescript
llmRubric("Response is helpful, accurate, and well-formatted")
llmRubric("Answer is concise", {
  passThreshold: 0.75,
  examples: [
    { output: "Yes.", score: 4, reasoning: "Direct and concise" },
    { output: "Well, I think maybe...", score: 1, reasoning: "Rambling" },
  ],
})
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `passThreshold` | number | `0.75` | Score threshold for passing (0–1) |
| `examples` | array | — | Few-shot calibration examples (output, score 1–4, reasoning) |

Default pass threshold of 0.75 maps to a judge score of 3 or higher.

### `factuality`

Specialized LLM judge that evaluates factual consistency against a reference. Requires `expected.text` as the ground truth.

```typescript
factuality()
factuality({ passThreshold: 0.9 })
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `passThreshold` | number | `0.75` | Score threshold for passing (0–1) |

Evaluates accuracy, completeness, and absence of fabrication.

### `llmClassify`

Classifies agent output into one of N categories using an LLM judge. Passes when classification matches `expected.metadata.classification`.

```typescript
llmClassify({
  helpful: "Answers the question directly",
  unhelpful: "Does not answer the question",
})
llmClassify(
  { positive: "Positive sentiment", negative: "Negative sentiment" },
  { criteria: "Classify based on overall tone" },
)
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `criteria` | string | — | Additional classification instructions |

If no expected classification is set on the case, runs in classification-only mode (always passes).

## Composition Operators

Combine graders with boolean logic. These operators do not short-circuit — they collect all results for complete reporting.

### `all`

Conjunction: all graders must pass. Score is the minimum of all scores.

```typescript
all([contains("Paris"), toolCalled("search"), latency(5000)])
```

Empty list returns pass (vacuous truth).

### `any`

Disjunction: at least one grader must pass. Score is the maximum of all scores.

```typescript
any([contains("capital of France"), contains("Paris")])
```

Empty list returns fail.

### `not`

Negation: inverts a grader's result. Score becomes `1 - original`.

```typescript
not(contains("I don't know"))
```

## Weighted Scoring

Apply multiple graders per case with weights. The final score is a weighted average. A case passes if the weighted score meets the pass threshold (default: 0.5).

```typescript
graders: [
  { grader: contains("hello"), weight: 0.3 },
  { grader: latency(5000), weight: 0.2 },
  { grader: llmRubric("Helpful response"), weight: 0.5 },
]
```
